<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jerry&#39;s Blog</title>
  <meta name="author" content="ShiJianjian">
  
  <meta name="description" content="Linux 学习心得，技术分享">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="generator" content="Hexo 2.6.0"/>

  
  <meta property="og:site_name" content="Jerry&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="shortcut icon">

  
    <link rel="stylesheet" href="/css/highlightjs/atelier-estuary-light.css">
  
  <script src="/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="alternate" href="/atom.xml" title="Jerry&#39;s Blog" type="application/atom+xml">

  <link href="/css/site.css" rel="stylesheet">
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <script type="text/javascript" src="/js/jquery.caption.min.js"></script>
  <link href="/css/captionjs.min.css" rel="stylesheet"/>
  <script type="text/javascript" src="/js/ewal.js"></script>

  
  




</head>

<body>


<div class="navbar navbar-default navbar-static-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><span class="text-primary">Jerry's Blog</span></a>
    </div>
    <div class="collapse navbar-collapse navbar-right">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav pull-right">
      
      
      
      
      </ul>
    </div>
  </div>
</div>


<div class="container">
	<div class="row">
		<div class="col-md-8">
			<div class="container-fluid">
				<div class="row">
					<div class="col-sm-11 col-md-11">
						
						<article class="post">
  
    
  
    <h1 class="title"><a href="/2018/10/30/NetworkProtocol/"></a></h1>
  

    <div class="post-date">
      <time datetime="2018-10-30T02:45:32.997Z">2018-10-30</time>
    </div>
  
  <div class="post-content">
    
      <h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h2 id="什么是网络？"><a href="#什么是网络？" class="headerlink" title="什么是网络？"></a>什么是网络？</h2><p>网络是把各种设备连接起来，按照一定的通讯协议，进行通讯的集合。</p>
<h2 id="网络物理拓扑结构"><a href="#网络物理拓扑结构" class="headerlink" title="网络物理拓扑结构"></a>网络物理拓扑结构</h2><ul>
<li>总线拓扑</li>
<li>环状拓扑</li>
<li>星型拓扑</li>
<li>扩展星型拓扑</li>
<li>网状拓扑</li>
<li>双环拓扑</li>
</ul>
<h2 id="OSI参考模型"><a href="#OSI参考模型" class="headerlink" title="OSI参考模型"></a>OSI参考模型</h2><ol>
<li>应用层  application</li>
<li>表示层  persention</li>
<li>会话层  session</li>
<li>传输层  transport</li>
<li>网络层  network</li>
<li>数据链路层  data link</li>
<li>物理层  physical</li>
</ol>
<h3 id="网络模型分层的意义"><a href="#网络模型分层的意义" class="headerlink" title="网络模型分层的意义"></a>网络模型分层的意义</h3><ul>
<li>降低复杂性</li>
<li>标准化接口</li>
<li>简化模块化设计</li>
<li>确保技术的互操作性</li>
<li>加快发展速度</li>
<li>简化教学</li>
</ul>
<h3 id="PDU-Protocol-Data-Unit"><a href="#PDU-Protocol-Data-Unit" class="headerlink" title="PDU Protocol Data Unit"></a>PDU Protocol Data Unit</h3><p>协议数据单元是指对等层次之间传递的数据单位</p>
<ul>
<li>物理层的PDU是数据位 bit</li>
<li>数据链路层的PDU是数据帧 frame</li>
<li>网络层的PDU是数据包 packet</li>
<li>传输层的PDU是数据段 segment</li>
<li>其他更高层次的PDU是消息 message</li>
</ul>
<h2 id="通讯模式"><a href="#通讯模式" class="headerlink" title="通讯模式"></a>通讯模式</h2><ul>
<li>单播</li>
<li>广播</li>
<li>组播</li>
</ul>
<h2 id="LAN-组成"><a href="#LAN-组成" class="headerlink" title="LAN 组成"></a>LAN 组成</h2><ul>
<li>计算机  </li>
<li><ul>
<li>PCs</li>
</ul>
</li>
<li><ul>
<li>Servers</li>
</ul>
</li>
<li>网络互联</li>
<li><ul>
<li>NICs</li>
</ul>
</li>
<li><ul>
<li>Media</li>
</ul>
</li>
<li>网络设备</li>
<li><ul>
<li>Hubs</li>
</ul>
</li>
<li><ul>
<li>Switches</li>
</ul>
</li>
<li><ul>
<li>Routers</li>
</ul>
</li>
<li>Protocols</li>
<li><ul>
<li>Ethernet</li>
</ul>
</li>
<li><ul>
<li>IP</li>
</ul>
</li>
<li><ul>
<li>ARP</li>
</ul>
</li>
<li><ul>
<li>DHCP</li>
</ul>
</li>
</ul>
<h2 id="Ethernet-Frame-结构"><a href="#Ethernet-Frame-结构" class="headerlink" title="Ethernet Frame 结构"></a>Ethernet Frame 结构</h2><p><img src="https://user-images.githubusercontent.com/43201545/47615726-cad71e00-daed-11e8-9d55-4c73c1eca4be.png" alt="image"></p>
<p>Ethernet </p>
<ul>
<li>preamble 8Byte</li>
<li>Destination Address 6Byte</li>
<li>Source Address 6Byte</li>
<li>Type 2Byte</li>
<li>Data 46-1500 Byte</li>
<li>Fcs 4Byte</li>
</ul>
<p>IEEE 802.3</p>
<ul>
<li>Preamble 7Byte</li>
<li>SOF 1Byte</li>
<li>Destination Address 6Byte</li>
<li>Source Address 6Byte</li>
<li>Type 2Byte</li>
<li>Data 46-1500 Byte</li>
<li>Fcs 4Byte</li>
</ul>
<h2 id="HUB集线器"><a href="#HUB集线器" class="headerlink" title="HUB集线器"></a>HUB集线器</h2><pre><code>Hub：多端口中继器  属于物理层设备，它检查帧不是自己的就被抛弃
Hub的特点：共享带宽，半双工     
Hub 在网络中对每个端口都转发，flood 泛洪
在Hub上同一时间只有一个信号在传输
Hub 既不隔断冲突域也不隔断广播域
</code></pre><p>冲突域：当一个主机向网络中发送报文，另一个主机也发送报文，产生冲突，两个主机在一个冲突域中<br>广播域：一个主机发送广播，另一个主机收到，两个主机在一个广播域</p>
<h2 id="交换机-以太网桥"><a href="#交换机-以太网桥" class="headerlink" title="交换机 以太网桥"></a>交换机 以太网桥</h2><p>任何一个数据报文到达交换机都可以转发，可以转发多路信号<br>交换机能够分析帧结构，属于数据链路层设备<br>    多路信号同时可以传<br>    内置表端口满了以后就广播转发</p>
<pre><code>交换机表中记录的是数据报文的源地址，而广播地址只能作为目标地址，永远不能成为源地址，不可能成为源地址，不能存在MAC地址表中，所以只能泛洪
广播地址表现为 FF:FF:FF:FF:FF:FF
广播地址不会记录在数据表，所以只能泛洪
只能隔断冲突域，不能隔断广播域
</code></pre><h2 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h2><p>路由器属于网络层</p>
<pre><code>多播，广播都被隔断，隔断广播域
可以做安全策略
选择最佳路径，存放路由表，路由策略，路由算法
连接广域网
</code></pre><p>路由：把一个数据包从一个设备发送到不同网络里的另一个设备上去。这些工作依靠路由器来完成。路由器只关心网络的状态和决定网络中的最佳路径。路由的实现依靠路由器中的路由表来完成</p>
<h2 id="TCP-IP-协议栈"><a href="#TCP-IP-协议栈" class="headerlink" title="TCP/IP 协议栈"></a>TCP/IP 协议栈</h2><p>Transmission Control Protocol/Internet Protocol<br>传输控制协议/因特网互联协议</p>
<p>TCP/IP是一个Protocol Stack，包括TCP、IP、UDP、ICMP、RIP、TELNET、FTP、SMTP、ARP等许多协议</p>
<p>共定义了四层和ISO参考模型的分层有对应关系</p>
<ol>
<li>应用层</li>
<li>传输层</li>
<li>Internet层</li>
<li>网络访问层</li>
</ol>
<h3 id="TCP-特点"><a href="#TCP-特点" class="headerlink" title="TCP 特点"></a>TCP 特点</h3><ul>
<li>工作在传输层</li>
<li>面向连接协议</li>
<li>全双工协议</li>
<li>半关闭</li>
<li>错误检查</li>
<li>将数据打包成段，排序</li>
<li>确认机制</li>
<li>数据恢复，重传</li>
<li>流量控制，滑动窗口</li>
<li>拥塞控制，慢启动和拥塞避免算法</li>
</ul>
<h3 id="TCP-包头"><a href="#TCP-包头" class="headerlink" title="TCP 包头"></a>TCP 包头</h3><p>固定长度 20 Byte<br>（单位 bit）</p>
<table>
<thead>
<tr>
<th>源端口</th>
<th>目的端口</th>
<th>序号</th>
<th>确认号</th>
<th>数据偏移</th>
<th>保留</th>
<th>URG</th>
<th>ACK</th>
<th>PSH</th>
<th>PST</th>
<th>SYN</th>
<th>FIN</th>
<th>窗口</th>
<th>校验和</th>
<th>紧急指针</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
<td>16</td>
<td>32</td>
<td>32</td>
<td>4</td>
<td>6</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>16</td>
<td>16</td>
<td>16</td>
</tr>
</tbody>
</table>
<h3 id="TCP-端口号"><a href="#TCP-端口号" class="headerlink" title="TCP 端口号"></a>TCP 端口号</h3><p>用来标识每个应用程序的地址   0-65535</p>
<p>它是基于 C/S 结构 client/server </p>
<p>常见端口号</p>
<pre><code>ssh C/S tcp 22
http:tcp 80
QQ:udp 8000
https:tcp 443
dhcp:tcp 67,68
snmp:tcp 161
mysql:tcp 3306
oracle:tcp 1521
sql:server:tcp 1433
kerberos:tcp 88
smtp:tcp 25
pop3:tcp 110
imap:tcp 143
smb:tcp 445
</code></pre><p>有限状态机 FSM:Finite State Machine</p>
<p>状态：描述</p>
<ul>
<li>CLOSED：无连接是活动 的或正在进行</li>
<li>LISTEN：服务器在等待进入呼叫</li>
<li>SYN_RECV：一个连接请求已经到达，等待确认</li>
<li>SYN_SENT：应用已经开始，打开一个连接</li>
<li>ESTABLISHED：正常数据传输状态</li>
<li>FIN_WAIT1：应用说它已经完成</li>
<li>FIN_WAIT2：另一边已同意释放</li>
<li>ITMED_WAIT：等待所有分组死掉</li>
<li>CLOSING：两边同时尝试关闭</li>
<li>TIME_WAIT：另一边已初始化一个释放</li>
<li>LAST_ACK：等待所有分组死掉</li>
</ul>
<h3 id="TCP-三次握手"><a href="#TCP-三次握手" class="headerlink" title="TCP 三次握手"></a>TCP 三次握手</h3><p>TCP 建立连接需要同步，确认三次，俗称三次握手<br><img src="https://user-images.githubusercontent.com/43201545/47616883-56a47680-dafd-11e8-9273-203e98c8723e.png" alt="image"></p>
<h3 id="TCP-四次挥手"><a href="#TCP-四次挥手" class="headerlink" title="TCP 四次挥手"></a>TCP 四次挥手</h3><p>TCP 断开连接需要四次请求，确认，四次挥手<br><img src="https://user-images.githubusercontent.com/43201545/47617203-dfbcad00-daff-11e8-91ab-d8ba27e75bcd.png" alt="image"></p>
<h3 id="sync半连接和accept全连接队列"><a href="#sync半连接和accept全连接队列" class="headerlink" title="sync半连接和accept全连接队列"></a>sync半连接和accept全连接队列</h3><p><img src="https://user-images.githubusercontent.com/43201545/47617252-37f3af00-db00-11e8-896a-559e929b82e7.png" alt="image"></p>
<h3 id="UDP-特性"><a href="#UDP-特性" class="headerlink" title="UDP 特性"></a>UDP 特性</h3><ul>
<li>工作在传输层</li>
<li>提供不可靠的网络访问</li>
<li>非面向连接协议</li>
<li>有限的错误检查</li>
<li>传输性能高</li>
<li>无数据恢复特性</li>
</ul>
<h3 id="UDP包头"><a href="#UDP包头" class="headerlink" title="UDP包头"></a>UDP包头</h3><p>（单位 bit）</p>
<table>
<thead>
<tr>
<th>源地址</th>
<th>目标地址</th>
<th>UDP 长度</th>
<th>UDP 校验和</th>
<th>数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
<td>16</td>
<td>16</td>
<td>16</td>
</tr>
</tbody>
</table>
<h3 id="InternetProtocol-特性"><a href="#InternetProtocol-特性" class="headerlink" title="InternetProtocol 特性"></a>InternetProtocol 特性</h3><ul>
<li>运行于OSI网络层</li>
<li>面向无连接的协议</li>
<li>独立处理数据包</li>
<li>分层编址</li>
<li>尽力而为传输</li>
<li>无数据恢复功能</li>
</ul>
<h3 id="IP-协议报头"><a href="#IP-协议报头" class="headerlink" title="IP 协议报头"></a>IP 协议报头</h3><p>固定部分 20 Byte<br>(单位 bit)</p>
<table>
<thead>
<tr>
<th>版本</th>
<th>首部长度</th>
<th>区分服务</th>
<th>总长度</th>
<th>标识</th>
<th>标志</th>
<th>片偏移</th>
<th>生存时间</th>
<th>协议</th>
<th>首部检验和</th>
<th>源地址</th>
<th>目的地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>4</td>
<td>8</td>
<td>16</td>
<td>16</td>
<td>3</td>
<td>13</td>
<td>8</td>
<td>8</td>
<td>16</td>
<td>32</td>
<td>32</td>
</tr>
</tbody>
</table>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>路由器是单向设备<br>    路由表 决定了如何选择一条路径，把收到的数据报文转发到目标主机的所在地</p>
<pre><code>    route -n （Linux命令）
    rout print （Windows命令）

目标网络ID：目标IP所在网络ID
接口：本设备要发送数据包到目标，从那个接口发送出来，才能到达
网关：到达目标网络，需要将数据交给下一个路口哪个接口的对应的IP

主机路由 192.168.32.100/32  优先级高于网络路由
网络路由 192.168.64.0/19  优先级次之
默认路由 0,0,0,0/0  优先级最低

添加默认网关的目的就是为了生成默认路由
</code></pre><p>动态路由</p>
<pre><code>RIP OSPF BGP ISIS路由协议
RIP 经过的路由器数量越少，就认为最优
OSPF 会考虑带宽
</code></pre>
    
  </div>
  
      <div class="row">
    
    
    </div>
  
  <div class="addthis_toolbox addthis_default_style 
addthis_32x32_style" data-addthis-url="http://yoursite.com/2018/10/30/NetworkProtocol/" data-addthis-title="">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
  
  

</article>

						
						<article class="post">
  
    
  
    <h1 class="title"><a href="/2018/10/29/hello-world/">Hello World</a></h1>
  

    <div class="post-date">
      <time datetime="2018-10-29T14:42:53.258Z">2018-10-29</time>
    </div>
  
  <div class="post-content">
    
      <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre><code class="bash">$ hexo new &quot;My New Post&quot;
</code></pre>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre><code class="bash">$ hexo server
</code></pre>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre><code class="bash">$ hexo generate
</code></pre>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre><code class="bash">$ hexo deploy
</code></pre>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

    
  </div>
  
      <div class="row">
    
    
    </div>
  
  <div class="addthis_toolbox addthis_default_style 
addthis_32x32_style" data-addthis-url="http://yoursite.com/2018/10/29/hello-world/" data-addthis-title="Hello World">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
  
  

</article>

						
						

					</div>
				</div>
			</div>
		</div>
		<div class="col-md-offset-1 col-md-3"><div class="sidebar-nav">

</div>
</div>
	</div>
</div>
<div id="push"></div>
<div class="navbar navbar-footer">
  <div class="container">
    <p class="navbar-center navbar-text">
      
      &copy; 2018 ShiJianjian
      
    </p>
  </div>
</div>
<script src="/js/bootstrap.min.js"></script>






</body>
</html>